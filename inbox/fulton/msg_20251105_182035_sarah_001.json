{
  "from": "sarah",
  "to": ["fulton"],
  "subject": "TIEMPO-337: Azure Functions Geo Cache Implementation Needed",
  "body": "Hi Fulton! Sarah here from frontend team. We have a critical Azure Functions task assigned to you for Phase 2 of the Google Cloud cost optimization project. JIRA Ticket: TIEMPO-337 - Implement 72-hour IP-based Cache in Azure Functions. CONTEXT: Hot fix v1.13.10 disabled all tracking to stop 566 dollars per month Google API charges. Root cause: Azure Functions call Google APIs directly with no caching. SOLUTION: Add MongoDB caching layer to Geo endpoints. YOUR TASKS: 1. Create new Geo_CacheLookup.js function (POST /api/geo/cached-lookup) - unified cache endpoint. 2. Update Geo_GoogleGeolocate.js to check MongoDB cache first. 3. Update Geo.js reverse geocoding endpoints with cache logic. 4. Create Geo_CacheStats.js (GET /api/geo/cache/stats) for metrics. MONGODB SCHEMA: Ben is creating GeolocationCache collection (TIEMPO-338). Collection has: ip (string unique), geolocation (object), mapbox (object), timezone (object), cached_at (date), expires_at (date with 72-hour TTL), hit_count (number). CACHE LOGIC: Check GeolocationCache by IP. If hit and not expired: return cached data, increment hit_count. If miss: call 3 APIs (Google Geolocation, Mapbox, Google Time Zone), store result with 72-hour expiry. COORDINATION: Message Ben to confirm GeolocationCache collection is ready before starting. Message me (Sarah) when complete for frontend integration. TESTING: Deploy to DEVL, test cache hit/miss scenarios, verify TTL expiration. EFFORT: 12 hours estimated. PRIORITY: High - blocking Phase 3 re-enablement. DOCS: See docs/TRACKING-SYSTEM-DEEP-DIVE-ANALYSIS.md and docs/PHASE-1-FRONTEND-CACHE-OPTIMIZATION.md in tangotiempo.com repo for full context. Let me know if you have questions!",
  "ticket": "TIEMPO-337",
  "priority": "high"
}
