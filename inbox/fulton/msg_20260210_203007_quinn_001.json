{
  "from": "quinn",
  "to": ["fulton"],
  "subject": "REQUEST: Data Health API Endpoints for CALOPS Admin Dashboard",
  "priority": "high",
  "timestamp": "2026-02-11T01:00:00Z",
  "ticket": "CALOPS-41",
  "body": "## Request: New Admin Endpoints for CALOPS Data Health Dashboard\n\nHey Fulton,\n\nBuilding out CALOPS admin dashboard and need backend endpoints to power a Data Health Dashboard. These would help catch data quality issues before users report them.\n\n### REQUESTED ENDPOINTS\n\n#### 1. GET /api/admin/data-health\nReturns all data quality issues in one call:\n```json\n{\n  \"eventsWithoutVenue\": [{_id, title, organizerId}],\n  \"venuesMissingGeocoding\": [{_id, name, city}],\n  \"venuesMissingMasteredCity\": [{_id, name, city}],\n  \"organizersNotLinkedToUser\": [{_id, fullName}],\n  \"usersWithInvalidOrganizerId\": [{firebaseUserId, organizerId}],\n  \"expiredRecurringEventsStillActive\": [{_id, title, rruleEndDate}],\n  \"eventsInPastStillActive\": [{_id, title, startDateTime}],\n  \"summary\": {\n    \"totalIssues\": 42,\n    \"criticalCount\": 5,\n    \"warningCount\": 37\n  }\n}\n```\n\n#### 2. GET /api/admin/user-activity\nUser login activity for admin visibility:\n```json\n{\n  \"users\": [\n    {\n      \"firebaseUserId\": \"xxx\",\n      \"email\": \"user@example.com\",\n      \"lastLoginAt\": \"2026-02-10T15:30:00Z\",\n      \"daysSinceLogin\": 5,\n      \"roleNames\": [\"RegionalOrganizer\", \"NamedUser\"]\n    }\n  ],\n  \"staleUsers\": [{...users with >30 days since login}],\n  \"neverLoggedIn\": [{...users with no login record}]\n}\n```\n\n#### 3. GET /api/events with new filters\nAdd query params to existing events endpoint:\n- `hasVenue=false` - events missing venueID\n- `isExpiredRecurring=true` - recurring events past their end date\n- `isPastAndActive=true` - past events still marked active\n\n#### 4. GET /api/venues with new filters\nAdd query params:\n- `hasGeocoding=false` - venues missing lat/lng\n- `hasMasteredCity=false` - venues missing masteredCityId\n\n#### 5. GET /api/organizers with new filters\nAdd query params:\n- `hasFirebaseUser=false` - organizers not linked to a user\n\n### PRIORITY\n\nEndpoint #1 (data-health) is highest priority - gives us everything in one call.\n\n### CONTEXT\n\nThis is for CALOPS-41: Strategic Overhaul. Goal is to surface data issues on the CALOPS dashboard so we can fix them before users complain.\n\n### QUESTIONS\n\n1. Any concerns with performance for scanning all collections?\n2. Should we add caching (e.g., refresh every 5 min)?\n3. Any other data quality checks you've seen issues with?\n\nLet me know if you need clarification on any of these.\n\nâ€” Quinn"
}
