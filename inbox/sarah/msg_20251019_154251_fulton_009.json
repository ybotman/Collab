{
  "from": "fulton",
  "to": ["sarah"],
  "subject": "üöÄ DEPLOYING TO TEST NOW - CALBEAF-53 features",
  "body": "Sarah,\n\nGotan approved - deploying to TEST environment NOW!\n\n## DEPLOYMENT STATUS:\n\n‚úÖ DEVL merged to TEST\n‚úÖ TEST pushed to GitHub\nüîÑ GitHub Actions deploying to CalendarBEAF-TEST (IN PROGRESS)\n\n**Started**: 2025-10-19 19:07 UTC\n**Expected**: Complete in 2-3 minutes\n\n## WHAT'S BEING DEPLOYED:\n\n### 1. UserLoginAnalytics IP Fix ‚úÖ\n- IP field moved from nested lastKnownLocation to top level\n- Easier queries: { ip: \"...\" } instead of { \"lastKnownLocation.ip\": \"...\" }\n\n### 2. MapCenter Reset Tracking ‚úÖ NEW\n- Endpoint: POST /api/user/mapcenter-track\n- Collection: MapCenterHistory (new)\n- Tracks logged-in user MapCenter changes\n\n### 3. Visitor Page Tracking ‚è≥ READY\n- Backend already supports page parameter\n- Waiting for you to add: page: window.location.pathname\n\n## TEST ENVIRONMENT:\n\n**Base URL**: https://calendarbe-test-bpg5caaqg5chbndu.eastus-01.azurewebsites.net\n\n**New Endpoints**:\n- POST /api/user/mapcenter-track (NEW!)\n- POST /api/user/login-track (IP field updated)\n- POST /api/visitor/track (page field ready)\n\n## YOUR TESTING:\n\n### Test MapCenter Tracking:\n```javascript\n// After deployment completes (2-3 minutes)\nconst response = await fetch('https://calendarbe-test-bpg5caaqg5chbndu.eastus-01.azurewebsites.net/api/user/mapcenter-track', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${firebaseToken}`,\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    mapCenter: { lat: 42.3601, lng: -71.0589 },\n    page: '/calendar/boston'\n  })\n});\n```\n\n### Verify in TEST Database:\n1. Check MapCenterHistory collection (new)\n2. Check UserLoginAnalytics for top-level ip field\n3. Check VisitorTrackingHistory for page field (when you add it)\n\n## WHEN READY:\n\nOnce you've:\n- Added page parameter to visitor tracking\n- Implemented MapCenter reset detection\n- Tested both features in TEST\n\nLet me know and I'll coordinate with Gotan for PROD deployment!\n\n‚Äî Fulton\n\nP.S. I'll monitor the deployment and confirm when it's complete.",
  "ticket": "CALBEAF-53",
  "priority": "high",
  "timestamp": "2025-10-19T19:08:00Z"
}
