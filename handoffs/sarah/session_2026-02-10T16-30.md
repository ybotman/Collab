# Session Handoff: Sarah @ 2026-02-10T16:30

## Current Status
Implemented version refresh on login (TIEMPO-368), researched user issues with map center persistence

## Active Ticket
- **Ticket**: TIEMPO-368
- **Status**: completed (merged to TEST, ready for PROD)

## What I Did This Session
- Created TIEMPO-368: Force version refresh on login to prevent stale client code
- Implemented `scripts/generate-version.js` to create version.json at build time
- Added version check in AuthContext.js after successful login with console logging
- Tested locally - version mismatch detection working
- Merged to DEVL, bumped to v1.19.8, pushed to TEST
- Researched Simonida's issue (Vida Mia events, can't see events)
- Found her events exist in DB, her RO permissions are correct
- Discovered map center/geolocation persistence issues:
  - sessionStorage NOT cleared on logout (bug)
  - Localhost skips cloud save (intentional but hides bugs)
- Found 7 orphaned BTC-imported events with missing UNKNOWN organizer
- Listed 27 approved Regional Organizers

## Next Session Should
1. Check inbox for messages
2. Consider pushing TIEMPO-368 to PROD after user confirms TEST is working
3. Fix logout flow to clear sessionStorage('currentLocation') - new ticket needed
4. Optionally clean up 7 orphaned BTC events (assign to real organizers or create UNKNOWN placeholder)

## Key Decisions Made
- Version check on login only (not for anonymous users): Protects the 2-5% admin users who do CRUD without bothering the 75% casual readers
- Console logging left in for testing: User can verify version check is working in browser devtools

## Context for Future Me
- Simonida (tangoaffair@gmail.com) reported: "cannot see any events", "added Vida Mia yesterday but not there anymore", "save as default doesn't persist"
- Her events DO exist in DB (Vida Mia, updatedAt 2026-02-09)
- Her user record and RO permissions are correct
- Issue is likely stale frontend code (fixed by TIEMPO-368) OR map center persistence bug
- Map center bug: `sessionStorage.currentLocation` is NOT cleared on logout in AuthContext.logOut()
- 7 events have ownerOrganizerID="680669192f926881302124bb" which doesn't exist (deleted UNKNOWN organizer from old BTC import)
- Production AF is at v1.20.0, TEST branch has 12 commits not yet in PROD

## Branch Status
- DEVL: v1.19.8 (46f0e95)
- TEST: v1.19.8 (46f0e95)
- PROD: v1.19.7 (needs merge from TEST)
