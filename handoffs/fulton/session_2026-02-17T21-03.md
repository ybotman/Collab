# Session Handoff: Fulton @ 2026-02-17T21:02

## Current Status
PROD IS DOWN - CalendarBEAF-PROD trigger sync failing, testing new CalendarAF-PROD app

## Active Ticket
- **Ticket**: None (operational emergency)
- **Status**: in_progress

## What Happened This Session
1. Changed CalendarBEAF-PROD MONGODB_URI to point to TangoTiempoProd
2. Updated Health_MongoDB*.js files to use dynamic db names
3. PROD started returning 503 errors
4. "Sync Web Apps Function Triggers" kept failing with "BadRequest"
5. Reverted MONGODB_URI back to TangoTiempo - still 503
6. Reverted code changes - still 503
7. Force deployed - still failing trigger sync
8. Created new function app CalendarAF-PROD to test
9. Deployment to CalendarAF-PROD in progress (may have same issue)

## Key Files
- `prod-settings-backup.json` - Backup of all PROD env variables (24 settings)

## Current State
| App | URL | Status |
|-----|-----|--------|
| CalendarBEAF-PROD | calendarbeaf-prod.azurewebsites.net | DOWN (503) |
| CalendarBEAF-TEST | calendarbeaf-test.azurewebsites.net | WORKING |
| CalendarAF-PROD | calendaraf-prod.azurewebsites.net | DEPLOYING |

## Node Version Warning
Azure warned: "Use node version 24 as 20 will reach end-of-life on 2026-04-30"
Consider updating node runtime.

## Next Session Should
1. Check if CalendarAF-PROD deployment succeeded
2. If yes: point Vercel to new URL and delete old CalendarBEAF-PROD
3. If no: investigate why trigger sync fails (check Kudu logs)
4. Consider node version upgrade to 24
5. DO NOT change MONGODB_URI until PROD is stable

## Databases
| Azure App | Should Point To | For |
|-----------|-----------------|-----|
| PROD | TangoTiempo | Live site |
| TEST | TangoTiempo | Testing |

Note: We attempted to separate PRODâ†’TangoTiempoProd but it caused issues. Leave as-is for now.

## Commands to Check Status
```bash
curl https://calendaraf-prod.azurewebsites.net/api/health
curl https://calendarbeaf-prod.azurewebsites.net/api/health
```

## Context for Future Me
The trigger sync "BadRequest" error is mysterious - same code works on TEST. Might be corruption in the CalendarBEAF-PROD app configuration. The new CalendarAF-PROD app is a test to see if fresh app works.
